<svg width="1000" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="errGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f43f5e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e11d48;stop-opacity:1" />
    </linearGradient>
    <marker id="errArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f43f5e"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="600" fill="#0f172a"/>

  <!-- Title -->
  <text x="500" y="45" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="28" font-weight="700" fill="#f8fafc">
    Error Reporting Flow
  </text>
  <text x="500" y="75" text-anchor="middle" font-family="Inter, sans-serif" font-size="16" fill="#94a3b8">
    How diagnostics get from code to terminal
  </text>

  <!-- Error creation -->
  <g transform="translate(50, 120)">
    <rect width="200" height="100" rx="12" fill="#1e293b" stroke="#f43f5e" stroke-width="2"/>
    <text x="100" y="35" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" font-weight="700" fill="#fda4af">LEXER ERROR</text>
    <text x="100" y="60" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">Unexpected char</text>
    <text x="100" y="80" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">Unterminated string</text>
  </g>

  <g transform="translate(50, 250)">
    <rect width="200" height="100" rx="12" fill="#1e293b" stroke="#f43f5e" stroke-width="2"/>
    <text x="100" y="35" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" font-weight="700" fill="#fda4af">PARSER ERROR</text>
    <text x="100" y="60" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">Unexpected token</text>
    <text x="100" y="80" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">Missing semicolon</text>
  </g>

  <g transform="translate(50, 380)">
    <rect width="200" height="100" rx="12" fill="#1e293b" stroke="#f43f5e" stroke-width="2"/>
    <text x="100" y="35" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" font-weight="700" fill="#fda4af">TYPE ERROR</text>
    <text x="100" y="60" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">Type mismatch</text>
    <text x="100" y="80" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">Undefined variable</text>
  </g>

  <!-- Arrows to Diagnostic -->
  <line x1="250" y1="170" x2="330" y2="260" stroke="#f43f5e" stroke-width="2" marker-end="url(#errArrow)"/>
  <line x1="250" y1="300" x2="330" y2="300" stroke="#f43f5e" stroke-width="2" marker-end="url(#errArrow)"/>
  <line x1="250" y1="430" x2="330" y2="340" stroke="#f43f5e" stroke-width="2" marker-end="url(#errArrow)"/>

  <!-- Diagnostic struct -->
  <g transform="translate(340, 200)">
    <rect width="280" height="200" rx="12" fill="url(#errGrad1)"/>
    <text x="140" y="35" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="18" font-weight="700" fill="white">Diagnostic</text>

    <g transform="translate(20, 55)">
      <text x="0" y="0" font-family="JetBrains Mono, monospace" font-size="12" fill="rgba(255,255,255,0.9)">severity: Error</text>
      <text x="0" y="25" font-family="JetBrains Mono, monospace" font-size="12" fill="rgba(255,255,255,0.9)">code: E1001</text>
      <text x="0" y="50" font-family="JetBrains Mono, monospace" font-size="12" fill="rgba(255,255,255,0.9)">message: "type mismatch"</text>
      <text x="0" y="75" font-family="JetBrains Mono, monospace" font-size="12" fill="rgba(255,255,255,0.9)">labels: [primary, secondary]</text>
      <text x="0" y="100" font-family="JetBrains Mono, monospace" font-size="12" fill="rgba(255,255,255,0.9)">notes: ["help: try..."]</text>
      <text x="0" y="125" font-family="JetBrains Mono, monospace" font-size="12" fill="rgba(255,255,255,0.9)">file_id: FileId(0)</text>
    </g>
  </g>

  <!-- Arrow to Source -->
  <line x1="620" y1="250" x2="680" y2="200" stroke="#3b82f6" stroke-width="2" stroke-dasharray="6,4"/>
  <line x1="620" y1="350" x2="680" y2="400" stroke="#3b82f6" stroke-width="2" stroke-dasharray="6,4"/>

  <!-- Source lookup -->
  <g transform="translate(690, 130)">
    <rect width="260" height="120" rx="12" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
    <text x="130" y="30" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" font-weight="700" fill="#93c5fd">SOURCE</text>
    <text x="130" y="55" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">offset_to_position(span)</text>
    <text x="130" y="80" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#94a3b8">get_line(line_num)</text>
    <text x="130" y="105" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#64748b">Binary search O(log n)</text>
  </g>

  <!-- Terminal output -->
  <g transform="translate(690, 350)">
    <rect width="260" height="180" rx="12" fill="#0c0c0c" stroke="#22c55e" stroke-width="2"/>
    <text x="20" y="30" font-family="JetBrains Mono, monospace" font-size="12" fill="#ef4444">error[E2001]</text>
    <text x="115" y="30" font-family="JetBrains Mono, monospace" font-size="12" fill="#f8fafc">: type mismatch</text>
    <text x="20" y="55" font-family="JetBrains Mono, monospace" font-size="11" fill="#3b82f6">  --&gt; main.nova:5:10</text>
    <text x="20" y="80" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">   |</text>
    <text x="20" y="100" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b"> 5 |</text>
    <text x="55" y="100" font-family="JetBrains Mono, monospace" font-size="11" fill="#f8fafc">let x: i32 = "hello"</text>
    <text x="20" y="120" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">   |</text>
    <text x="55" y="120" font-family="JetBrains Mono, monospace" font-size="11" fill="#ef4444">          ^^^^^^^</text>
    <text x="20" y="140" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">   |</text>
    <text x="55" y="140" font-family="JetBrains Mono, monospace" font-size="11" fill="#94a3b8">expected i32, found str</text>
    <text x="20" y="165" font-family="JetBrains Mono, monospace" font-size="11" fill="#22c55e">   = help: use .parse()</text>
  </g>

  <!-- Arrow to terminal -->
  <line x1="620" y1="300" x2="690" y2="440" stroke="#22c55e" stroke-width="3" marker-end="url(#errArrow)"/>

  <!-- Labels -->
  <text x="655" y="175" font-family="Inter, sans-serif" font-size="11" fill="#3b82f6">lookup</text>
  <text x="665" y="380" font-family="Inter, sans-serif" font-size="11" fill="#22c55e">emit</text>
</svg>
